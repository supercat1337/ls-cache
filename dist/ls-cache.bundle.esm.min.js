function f(h){let e=0;for(let t=0;t<h.length;t++)e=(e<<5)-e+h.charCodeAt(t)|0;return(e>>>0).toString(36)}var n=class{prefix="cache";#e;constructor(e="cache"){if(this.prefix=e,this.#e=o.storage,!this.#e)throw new Error("storage is undefined")}getKeyName(e){return o.keyEncoder(e)}write(e,t,i){let r=this.getKeyName(e);this.setKey(r,t,i)}read(e){let t=this.getKeyName(e),i=this.readKey(t);return i===null?null:i.value}readKey(e){let t=this.#e.getItem(`${this.prefix}.${e}.created`),i=parseInt(t);if(isNaN(i))return this.removeKey(e),null;let r=this.#e.getItem(`${this.prefix}.${e}.expires`),s=parseInt(r);if(isNaN(s))return this.removeKey(e),null;let l=this.#e.getItem(`${this.prefix}.${e}.value`);return l===null?(this.removeKey(e),null):Math.ceil(Date.now()/1e3)>s?(this.removeKey(e),null):{created:i,expires:s,value:l}}setKey(e,t,i){let r=Math.ceil(Date.now()/1e3),s=r+i;this.#e.setItem(`${this.prefix}.${e}.created`,r.toString()),this.#e.setItem(`${this.prefix}.${e}.expires`,s.toString()),this.#e.setItem(`${this.prefix}.${e}.value`,t)}getKeyNames(){let e=new Set;for(let i=0;i<this.#e.length;i++){let r=this.#e.key(i);if(r&&r.startsWith(`${this.prefix}.`)){let s=r.replace(`${this.prefix}.`,"").split(".")[0];e.add(s)}}let t=[];return e.forEach(i=>{this.readKey(i)!==null&&t.push(i)}),t}removeOutdatedKeys(){this.getKeyNames()}removeAll(){for(let e=0;e<this.#e.length;e++){let t=this.#e.key(e);t&&t.startsWith(`${this.prefix}.`)&&this.#e.removeItem(t)}}removeKey(e){this.#e.removeItem(`${this.prefix}.${e}.created`),this.#e.removeItem(`${this.prefix}.${e}.expires`),this.#e.removeItem(`${this.prefix}.${e}.value`)}removeKeysCreatedBefore(e){let t=Math.ceil(e.getTime()/1e3);for(let i=0;i<this.#e.length;i++){let r=this.#e.key(i);if(r&&r.startsWith(`${this.prefix}.`)){let s=r.replace(`${this.prefix}.`,"").split(".")[0],l=this.readKey(s);l!==null&&l.created<t&&this.removeKey(s)}}}},a=class{storage=globalThis.localStorage;keyEncoder=f},o=new a;export{n as CacheStorage,o as cacheStorageConfig};
